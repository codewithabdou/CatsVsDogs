<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cats Vs Dogs Classification</title>
    <link
      rel="shortcut icon"
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAIq0lEQVRYw6WWa3BV1RXH/2vv88zNi5AHgTyIISSIEAgPeUwUrFDFx9hqx9F2dDp2dGy105m2fFG/tLXtdPqYim0dWkundbSjBtEWqIoVCWhIkKcJGpKQBxCSkJt7b3If55x99uoHkCk2QqTr29lz9t6//d/rv9ciTDHOjGucPefL/uFkxZYPjGkh3JLZ+VxKAnzsNPfOKfTiD6+RYW15Vo8ledw15ZTWpSv90DmYptYT6RmH+8W6D7pFY9LHqlNxWZhSpmsJ6UJqeAFP5NvKn1sU+jOy1a7qwmDbhqXZbXPL3cHiCPFVAQRaY097qrBpv/pq68nwof64vSielFYAA0wEYg1NAnRhCQIAUrCERqEdpufP0ocWloW/vW+1/a/6KichSUwdIOGF4rWW5LIdR8On3zturz7nmQ4jBCkTwtBwLfZybT/tGgGICQnPQDwwnUDBCbUAICBIYVaOSt40T7+2upaeumdlpDff+d/tjMkAmpqHl/91n/XnloFInR8aJBjIdkJ/drF/srooaK4oct5zrcwn84oy0Bpo7beRyOia8VR4S+ewccOpmFmWUoY8E5eRVw4F93UN61JBqe8r1keMzygxKYAg+FqzrzSTIX2eMy04vqY23LL2Wt305Yb8PtcS2hCRS+YklW6LJ9XL2/an5rZ0+t94v9u4fyBmV3qelD2juHFwTN0eahwDoK8IcPfqwkO90eSjAfmbiiL+6Jo62njn9TnHqovti5O19ggAmEwGgAt3rAB0HO1LPrV1f2rn3i5s6hziupvnixcbr7W22FLoKSdhc0cCKqSFrqnHrqt0B1zHADJRIxjurNIHNheZTt71ysida7DfHQx1HKR5GwatWQ1dmLkskCSQ9BS93jZR3z3or26oyX3xtkXO2FXZEABYJSgYOFgd9O77DvU332acPTJDeEmXdGCQNNgz3FSYVzFCBXU7ac6XXnDm39Em3MLgqt6BvtEAjkmU4xJnmRLaT5DX/vpiffyNXxt9uxuFFxXEDGaCIA0Cg4UAswENU6vS+rNc/8Amp279piBSmXpx92jJjOk2r1+cM3w+na/ggkO9qqy9N/nNiiLzFV+pT7yPmq7lIy9tsgZ2r4TKkGCACWChQZqhSUAoDVAIFiys060zg0zqCd+Pj223HnnntYPiuews7UmRehRA/2UBWns86zdv6m/v/djduHJ2avZt1SNPZp3c9Qs5sG+lVB4xM0IBCCYY4acPEAFEIAYMHQLEsEaPZac77B+ULlhnnxqvqe7vlxW2GfywtSe9cfk1bvoSx/33x1uH/eUHTvK3PBZBZbHVJU/vvSns27dWqCQhJBAYhmYI1gBpgBiEEAADFIKgQXx+zBrqqK4ffK7+9oXB01kmj7/fJb7+zpHUqkx4qREuAkRTWuzppHUDMVlYW6KaNywSm40T/1xrxbpdwfrikzvVMNQEGUOtjY/PP/j+8kq9YyBh5rf1yXtHxtmYFOB0lEs05Fcs6HB2fvjqishR04z1NYgwgCZx/pRfAEILApLRWe7Ih5XlhfRSboS9U1Gx4lj3eOGkAMcHtXN23MxzHSNRkGsd4lhfEatkGUiDWINF+IUUUASQn8qSfqK2sc7oLIqIc6MTsuTjITE5wFhCwVeAY4dBUT4lOfSIOSQCQNAXFOApA0hmEGkwJE3PMZKmIC/DFg1N2DQpQH4EyoTyVaBdFYSFWkYSEEYcVxmCBNi0tHYK0od7fHsizYYl/OCa6f7kSZjw6JwlVMeEL7KHY8EKt6w+auQUnQERmL7o9gRNEtrOjgnLPNxxSs0fS3NxrqP6GmuNzKQADTVWZmZB2ByEhAN9xoam7jLHn1HfrIyckGGAWYAvl4R83ifEBDDATNBOyb4uu7G/d8x4MOOzU1Wgd5dOt3onBVgyU/CaOrVrTkHqzIkRc+X2g/yYqrzlDT1j8SkR4oIKn58DLABNBCYGE6AjhT5Xrd3+bl9J3rm4v7Qy3x9YWY2maa68pEZc0jk+/+yPR8+Mhm7PEN9gCu1eU1PxfLk9mtSJvjUyEzUufxPi/Okl4Nn5mqtuft1c8sAvnYKZQzoMhubNCFvW1Wft/NOmpz+/H6iYbgfvtKd/B2Qyc0rk0QVVkUE5896/6CBeHnQ0PWLE+l0BBfCFGsB8XhRxoa5pjcAp0GH5mnftueuflLOWjSwhAV/rlwmwTCHUVZXjINqdq9q3PY72rQ+KaNccI3OOQgLADMkMkAEtbei8sqhfeUOTOf/un9rVjb0ks/7/tvzTCEc7pH/u5AJ14t8bZLR7HY20Z8uJPmi7AFy8UMusvBbUrH8bZct2WSWLMlP3y+fEu0cTeUMxb2lNRd7+JbOtiYsgoUecGMjhD34l9dEXgNIVoJt/xqJ4/oRhuhcl7h1jau/LZFsSmXUL3OALAWz/MFn8apv60aE+3DOvNPzDXSuynlm30B4pcKYm2LaDSpyNpjdsbdPfLcnRb97f6Dx7a73rTVq0PjtwNuY5P2lKPvGPY+5DY55p9I4FG0cmguUDI+r3bx1Nvb2qxkhlu9akGw+Oh7Kt06t6oy1+z94u89GeqF0xPStcKmSQfO948o83zouEVwRQSquMr1oKHP9rsbQsTQTC2tPjrO8eCa4vyw3fXFXnH35+d7KlKNvrLs8L4YeE5i4hxuOofWxzbG1/3L6ze8SZG/OEBATGA84digeLdx5I05SvIKPCOZt2TKz4Wyt/7+SItTilTMGkIRnItjTnOxzPc9RYxAqhoBFLW5RIysK4LyNplkSKQUKjNCdMN5TTltsb1M8fvilnYMoAIWs7lQnVM2+lKgaG1MY93eKu3qhVHPimYCERXqyOJgQziAESDCUACR/TbOVdVxp8tH6B3LyqLuvvN9aZiauyYcgaJ4ZDd+u+sYYDXfLu/jHnjrMxv3o4bZIiFxACxApCK5gywMx8mqia7rfUlmDr2gWRHbcutk5lmZdvJP4Dl9dVkYcTQYMAAAAASUVORK5CYII="
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css"
    />
    <style>
      .upload-area {
        border: 2px dashed #4f46e5;
        transition: all 0.3s ease;
      }

      .upload-area:hover {
        border-color: #6366f1;
        background-color: #eef2ff;
      }

      .loader {
        border: 3px solid #f3f3f3;
        border-top: 3px solid #4f46e5;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .result-card {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border: 1px solid #e5e7eb;
      }

      .results-container {
        height: 600px;
        overflow-y: auto;
      }

      .processed-image {
        max-height: 300px;
        object-fit: contain;
      }

      pre {
        white-space: pre-wrap;
        word-wrap: break-word;
      }
    </style>
  </head>
  <body
    class="bg-gray-50 flex flex-col items-center justify-center md:px-[10%] min-h-screen"
  >
    <div
      class="w-full flex flex-col items-center justify-center mx-auto px-4 py-8"
    >
      <!-- Header -->
      <header class="text-center mb-12">
        <h1 class="text-4xl font-bold text-indigo-600 mb-2">
          Cats Vs Dogs Classification
        </h1>
        <p class="text-gray-600">
          Upload an image to identify the animal with AI
        </p>
      </header>

      <!-- Main Content -->
      <div class="flex w-full flex-col -mx-4">
        <!-- Left Column - Upload Section -->
        <div class="w-full px-4 mb-8">
          <div class="bg-white rounded-lg shadow-lg p-6">
            <div class="upload-area rounded-lg p-8 text-center mb-6">
              <div class="relative">
                <video
                  id="video"
                  class="w-full h-64 object-cover rounded-lg hidden"
                ></video>
                <img
                  id="photo"
                  class="w-full h-64 object-cover rounded-lg"
                  src="https://placehold.co/400x320"
                  alt="Preview"
                />
                <canvas id="canvas" class="hidden"></canvas>
              </div>
              <p class="text-gray-500 mt-4">
                Drag & drop your image here or click to browse
              </p>
            </div>

            <div class="flex space-x-4">
              <button
                id="upload"
                class="w-1/2 bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition duration-200"
              >
                Upload Image
              </button>
              <button
                id="send"
                class="w-1/2 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition duration-200"
              >
                Analyze Image
              </button>
            </div>
            <input type="file" id="fileinput" class="hidden" accept="image/*" />
            <input type="hidden" id="url" value="../predict" />
          </div>
        </div>

        <!-- Right Column - Results Section -->
        <div class="w-full px-4 mb-8">
          <div class="bg-white rounded-lg shadow-lg p-6 results-container">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">Results</h2>

            <!-- Detection Results Section -->
            <div>
              <h3 class="text-lg font-medium text-gray-700 mb-2">
                Detection Results
              </h3>
              <div class="bg-gray-100 rounded-lg p-4">
                <div class="jsonRes font-mono text-sm">
                  <p class="text-gray-500">
                    Detection results will appear here
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div
      id="loading"
      class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50"
    >
      <div class="bg-white p-6 rounded-lg shadow-xl">
        <div class="loader mx-auto"></div>
        <p class="text-gray-700 mt-4">Processing image...</p>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
      var base_data = "";

      function getResultContent(prediction) {
        const animal = prediction.image.toLowerCase();
        const isItCat = animal === "cat";

        return `
            <div class="result-badge">
                <div class="result-icon">
                    ${isItCat ? "üê±" : "üê∂"}
                </div>
                <div class="font-bold ${
                  isItCat ? "text-purple-600" : "text-blue-600"
                }">
                    It's a ${animal}!
                </div>
                <p class="text-gray-600 mt-2 text-sm">
                    ${
                      isItCat
                        ? "Meow! I detected a cat in this image."
                        : "Woof! I detected a dog in this image."
                    }
                </p>
            </div>
        `;
      }

      function sendRequest(base64Data) {
        if (!base64Data) return;

        const url = $("#url").val();
        $("#loading").removeClass("hidden").addClass("flex");

        $.ajax({
          url: url,
          type: "post",
          headers: {
            "Content-Type": "application/json",
            "Access-Control-Allow-Origin": "*",
          },
          data: JSON.stringify({ image: base64Data }),
          success: function (res) {
            try {
              $(".jsonRes").html(getResultContent(res[0]));
            } catch (e) {
              console.error("Error displaying results:", e);
              $(".jsonRes").html(
                `<p class="text-red-500">Error displaying results</p>`
              );
            }

            $("#loading").removeClass("flex").addClass("hidden");
          },
          error: function (err) {
            console.error("Request error:", err);
            $(".jsonRes").html(
              `<p class="text-red-500">Error processing request</p>`
            );
            $("#loading").removeClass("flex").addClass("hidden");
          },
        });
      }

      $(document).ready(function () {
        // Handle file upload button
        $("#upload").click(() => $("#fileinput").click());

        // Handle file selection
        $("#fileinput").change(function () {
          if (this.files?.[0]) {
            const reader = new FileReader();
            reader.onload = function (e) {
              const url = e.target.result;
              const img = new Image();
              img.crossOrigin = "Anonymous";
              img.onload = function () {
                const canvas = document.createElement("CANVAS");
                const ctx = canvas.getContext("2d");
                canvas.height = this.height;
                canvas.width = this.width;
                ctx.drawImage(this, 0, 0);
                base_data = canvas
                  .toDataURL("image/jpeg", 1.0)
                  .replace(/^data:image.+;base64,/, "");
              };
              img.src = url;
              $("#photo")
                .attr("src", url)
                .css({
                  display: "block",
                  objectFit: "contain",
                })
                .show();
              $("#video").hide();
            };
            reader.readAsDataURL(this.files[0]);
          }
        });

        // Handle analyze button
        $("#send").click(() => sendRequest(base_data));

        // Initialize drag and drop
        const dropArea = $(".upload-area")[0];

        ["dragenter", "dragover", "dragleave", "drop"].forEach((eventName) => {
          dropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
          e.preventDefault();
          e.stopPropagation();
        }

        ["dragenter", "dragover"].forEach((eventName) => {
          dropArea.addEventListener(eventName, highlight, false);
        });

        ["dragleave", "drop"].forEach((eventName) => {
          dropArea.addEventListener(eventName, unhighlight, false);
        });

        function highlight() {
          dropArea.classList.add("bg-indigo-50");
        }

        function unhighlight() {
          dropArea.classList.remove("bg-indigo-50");
        }

        dropArea.addEventListener("drop", handleDrop, false);

        function handleDrop(e) {
          const dt = e.dataTransfer;
          const files = dt.files;
          $("#fileinput")[0].files = files;
          $("#fileinput").change();
        }
      });
    </script>
  </body>
</html>
